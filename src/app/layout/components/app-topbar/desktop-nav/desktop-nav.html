<div class="hidden lg:flex justify-between gap-8 w-full text-sm font-bold">
  <div class="flex items-center gap-6">
    @for (link of links(); track link.path || link.name) {
    <div class="relative group text-sm">
      @if (link.children?.length) {
      <button
        (click)="toggleDropdown('link-' + $index, $event)"
        class="group flex items-center relative after:content-[''] after:absolute after:-bottom-1 after:left-0 after:w-full after:h-0.5 hover:text-primary-500 hover:transition-colors hover:duration-200 before:content-[''] before:absolute before:left-0 before:top-full before:w-full before:h-4 before:z-20">
        {{ link.translationKey ? (link.translationKey | translate) : link.name }}
        <i-lucide
          class="size-5 transition-transform duration-300 ml-0.5"
          [ngClass]="{'rotate-90': isDropdownOpen('link-' + $index)}"
          [name]="icons.chevronRight" />
        @if (link.children?.length) {
        <div
          class="absolute left-0 top-full pt-3 w-80 z-50 transition-all duration-300 origin-top"
          [ngClass]="{
            'opacity-100 visible': isDropdownOpen('link-' + $index),
            'opacity-0 invisible': !isDropdownOpen('link-' + $index)
          }">
          <div class="flex text-left flex-col divide-y divide-gray-200 py-2 bg-white shadow-xl rounded-lg">
            @for (sublink of link.children; track sublink.path || sublink.name) {
            <div class="relative group/sub px-4 py-2">
              <a
                routerLinkActive="bg-primary-100 text-primary-600"
                [routerLink]="sublink.path"
                [routerLinkActiveOptions]="{
                          exact: sublink.exactUrl || false,
                        }"
                class="block px-4 py-2 text-gray-700 font-medium hover:bg-primary-100 hover:text-primary-600 rounded-lg transition-colors duration-200">
                {{ sublink.translationKey ? (sublink.translationKey | translate) : sublink.name }}
              </a>
            </div>
            }
          </div>
        </div>
        }
      </button>
      } @else {
      <a
        [routerLink]="link.path"
        routerLinkActive="after:bg-primary-500"
        [routerLinkActiveOptions]="{ exact: link.exactUrl || false }"
        class="group flex items-center relative after:content-[''] after:absolute after:-bottom-1 after:left-0 after:w-full after:h-0.5 hover:text-primary-500 hover:transition-colors hover:duration-200">
        {{ link.translationKey ? (link.translationKey | translate) : link.name }}
      </a>
      }
    </div>
    }

    <button
      (click)="toggleDropdown('programs', $event)"
      class="group flex items-center relative hover:text-primary-500 hover:transition-colors hover:duration-200 before:content-[''] before:absolute before:left-0 before:top-full before:w-full before:h-4 before:z-20">
      {{ 'nav.programs' | translate }}
      <i-lucide
        class="size-5 ml-0.5 transition-transform duration-300"
        [ngClass]="{'rotate-90': isDropdownOpen('programs')}"
        [name]="icons.chevronRight" />
      @if (programs()) {
      <div
        class="absolute right-0 top-full pt-3 w-80 z-50 transition-all duration-300 origin-top"
        [ngClass]="{
          'opacity-100 visible': isDropdownOpen('programs'),
          'opacity-0 invisible': !isDropdownOpen('programs')
        }">
        <div class="flex flex-col divide-y divide-gray-200 py-2 bg-white shadow-xl rounded-lg">
          @for (p of programs(); track p.slug) {
          <div class="relative group/sub px-4 py-2 text-left">
            <a
              routerLinkActive="bg-primary-100 text-primary-600"
              [routerLink]="['/our-programs/' + p.slug]"
              [routerLinkActiveOptions]="{ exact: true }"
              class="block px-4 py-2 text-gray-700 font-medium hover:bg-primary-100 hover:text-primary-600 rounded-lg transition-colors duration-200">
              {{ translateField()(p.name, 'name', p) }}
              <span class="block text-base font-normal text-gray-500">
                {{ translateField()(p?.category?.name, 'name', p.category) }}
              </span>
            </a>
          </div>
          }
        </div>
      </div>
      }
    </button>
  </div>
  <div>
    @let currentUser = user(); @if (currentUser) {
    <div class="flex gap-3 items-center">
      <app-language-switcher />

      <button (click)="toggleDropdown('mycinolu', $event)" class="group relative flex items-center gap-1">
        <div class="flex items-center gap-1">
          <div class="relative h-8 w-8 min-h-8 min-w-8" style="position: relative">
            @if (currentUser.profile || currentUser.google_image) {
            <img
              [ngSrc]="currentUser | apiIMG: 'user'"
              alt="User Image"
              class="aspect-square object-cover ring-2 ring-primary-600 bg-gray-200 rounded-full"
              fill />
            }@else {
            <div
              class="w-8 h-8 rounded-full bg-gradient-to-br from-primary-500/90 to-primary-600/90 flex items-center justify-center font-bold text-white text-xs shadow-sm ring-2 ring-slate-200 group-hover:ring-primary-300 transition-all">
              {{ getUserInitials(currentUser) }}
            </div>
            }
          </div>
          <i-lucide
            [name]="icons.chevronRight"
            class="transition-transform size-5 ml-0.5 duration-300"
            [ngClass]="{'rotate-90': isDropdownOpen('mycinolu')}" />
        </div>
        <div
          class="absolute right-0 top-full mt-2 w-56 rounded-lg bg-white shadow-xl transition-all duration-300 z-50"
          [ngClass]="{
            'visible opacity-100': isDropdownOpen('mycinolu'),
            'invisible opacity-0': !isDropdownOpen('mycinolu')
          }">
          <div class="text-left flex flex-col divide-y divide-gray-200 py-2">
            <div class="flex flex-col px-4 py-2">
              <a
                routerLink="/dashboard"
                class="block rounded-lg px-4 py-2 font-medium text-gray-700 transition-colors duration-200 hover:bg-primary-100 hover:text-primary-600">
                {{ 'auth.myAccount' | translate }}
              </a>
            </div>
            <div class="flex flex-col px-4 py-2">
              <button
                class="flex rounded-lg px-4 py-2 font-medium text-gray-700 transition-colors duration-200 hover:bg-primary-100 hover:text-primary-600"
                (click)="onSignOut()">
                {{ 'auth.signOut' | translate }}
              </button>
            </div>
          </div>
        </div>
      </button>
    </div>
    } @else {
    <div class="flex gap-4 items-center">
      <app-language-switcher />

      <a
        routerLink="/sign-in"
        class="relative inline-flex items-center justify-center px-6 py-2 rounded-full border-1 border-primary-500 font-semibold text-primary-500 overflow-hidden group transition duration-300 ease-out hover:text-white">
        <span
          class="absolute inset-0 bg-primary-500 scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 ease-out">
        </span>
        <span class="relative">{{ 'auth.signIn' | translate }}</span>
      </a>

      <a
        routerLink="/sign-up"
        class="relative inline-flex items-center justify-center px-6 py-2 rounded-full border border-primary-500 font-semibold text-white overflow-hidden group transition duration-300 ease-out">
        <span
          class="absolute inset-0 bg-primary-500 scale-x-100 group-hover:scale-x-0 transition-transform origin-right duration-300 ease-out"></span>
        <span class="relative group-hover:text-primary-500">{{ 'auth.signUp' | translate }}</span>
      </a>
    </div>
    }
  </div>
</div>
