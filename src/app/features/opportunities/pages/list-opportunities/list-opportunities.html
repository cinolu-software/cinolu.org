<section class="relative min-h-screen overflow-hidden bg-gray-50">
  <div class="py-16 pt-32 px-6 lg:px-12 xl:px-20 2xl:px-28 max-w-screen-2xl mx-auto">
    <!-- Hero section -->
    <div class="mb-12 text-center">
      <h2
        class="text-4xl sm:text-5xl lg:text-6xl font-black font-satoshi tracking-tight text-gray-900 mb-4 leading-tight">
        {{ 'opportunities.list.title' | translate }}
      </h2>

      <p class="text-lg sm:text-xl text-gray-600 font-medium mb-6">{{ 'opportunities.list.subtitle' | translate }}</p>
    </div>

    <!-- Barre de recherche et filtres -->
    <div class="mb-10 max-w-4xl mx-auto space-y-4">
      <!-- Recherche -->
      <div class="relative group">
        <span
          class="absolute left-4 top-1/2 -translate-y-1/2 z-10 text-gray-400 group-hover:text-primary-500 transition-colors">
          <i-lucide [name]="icons.search" class="size-5" />
        </span>
        <input
          type="text"
          pInputText
          [value]="queryParams().q || ''"
          (input)="onSearch($event)"
          [placeholder]="'opportunities.list.search_placeholder' | translate"
          class="w-full pl-12 pr-5 py-4 bg-white border border-gray-200/60 rounded-lg text-base font-medium text-gray-900 placeholder:text-gray-400 shadow-sm hover:border-primary-300 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-400 transition-all duration-200" />
      </div>

      <!-- Filtre par tags -->
      @if (tagsStore.tags().length > 0) {
      <div class="relative">
        <p-multiSelect
          [inputId]="'tagsFilter'"
          [autocomplete]="'off'"
          [showHeader]="false"
          (onChange)="onTagsChange($event)"
          (onClear)="onClear()"
          [options]="tagsStore.tags()"
          [optionValue]="'id'"
          [optionLabel]="'name'"
          [showClear]="true"
          [placeholder]="'opportunities.list.choose_tag' | translate"
          styleClass="w-full"
          [style]="{'width': '100%'}"
          class="w-full rounded-lg" />
      </div>
      }
    </div>

    <!-- Grille de cartes -->
    <div class="flex flex-col items-center">
      @if (filteredOpportunities().length > 0 && !store.isLoading()) {
      <div class="w-full">
        <!-- Grid classique -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 lg:gap-6">
          @for (opportunity of filteredOpportunities() | paginate: { itemsPerPage: itemsPerPage, currentPage:
          +queryParams().page!, totalItems: totalCount() }; track opportunity.id) {
          <div class="transition-all duration-300 ease-out">
            <app-opportunity-card
              [opportunity]="opportunity"
              [buttonTextKey]="'opportunities.explore'"
              class="block h-full" />
          </div>
          }
        </div>

        <!-- Pagination -->
        @if (shouldShowPagination()) {
        <div class="flex justify-center mt-12 mb-8">
          <div class="bg-white rounded-lg border border-gray-200/60 shadow-sm p-2">
            <pagination-controls
              previousLabel="Précédent"
              nextLabel="Suivant"
              (pageChange)="onPageChange($event)"
              class="pg" />
          </div>
        </div>
        }
      </div>
      }

      <!-- État vide -->
      @if (!store.isLoading() && filteredOpportunities().length === 0) {
      <div class="relative w-full max-w-2xl mx-auto my-16">
        <div class="flex flex-col items-center gap-5 p-10 bg-white rounded-lg border border-gray-200/60 shadow-sm">
          <div class="flex items-center justify-center w-16 h-16 bg-gray-100 rounded-lg">
            <i-lucide [name]="icons.search" class="w-8 h-8 text-gray-400" />
          </div>
          <h2 class="text-2xl font-bold text-gray-800 text-center">
            {{ 'opportunities.list.no_opportunity' | translate }}
          </h2>
          <p class="text-gray-600 text-center max-w-md">
            Essayez de modifier vos critères de recherche ou revenez plus tard.
          </p>
        </div>
      </div>
      }

      <!-- Skeleton pour le filtre tags -->
      @if (tagsStore.isLoading()) {
      <div class="pb-2 pt-10 w-full max-w-2xl animate-pulse">
        <div
          class="w-full bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 rounded-2xl h-14 animate-shimmer bg-[length:200%_100%]"></div>
      </div>
      }

      <!-- Skeletons avec animation -->
      @if (store.isLoading()) {
      <div class="w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
        @for (i of skeletonArray; track $index) {
        <div [class]="'animate-fade-in-up-' + ($index % 9)">
          <app-opportunity-card-skeleton />
        </div>
        }
      </div>
      }
    </div>
  </div>
</section>
