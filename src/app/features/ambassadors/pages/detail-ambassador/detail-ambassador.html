<section class="px-6 lg:px-16 xl:px-24 2xl:px-32 max-w-screen-2xl mx-auto bg-grid pt-[7.5rem] pb-16">
  @if (store.ambassador(); as ambassador) {
  <div class="space-y-12">
    <div class="text-center">
      <h2 class="font-black font-satoshi text-3xl md:text-5xl lg:text-6xl text-gray-900 leading-tight tracking-tight">
        {{ ambassador.name }}
      </h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
      <div class="md:sticky md:top-28 2xl:top-36 3xl:mt-14 self-start">
        <div class="relative w-full overflow-hidden h-72 md:h-[34rem] rounded-lg shadow-2xl">
          @if (ambassador.profile) {
          <img
            [src]="ambassador | apiIMG: 'user'"
            [alt]="ambassador.name"
            class="relative object-cover w-full h-full block transition-transform duration-300 hover:scale-105"
            priority />
          } @else {
          <div
            class="relative w-full h-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-bold text-9xl">
            {{ getInitials(ambassador.name) }}
          </div>
          }
          @if (ambassadorBadge(); as badge) {
          <div class="absolute bottom-6 left-6 right-6">
            <div
              [class]="'inline-flex items-center px-4 py-2.5 rounded-full text-sm font-bold border shadow-lg backdrop-blur-sm ' + badge.color + ' ' + badge.bgColor + ' ' + badge.borderColor">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path
                  d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
              </svg>
              {{ badge.label }}
            </div>
          </div>
          }
        </div>
      </div>

      <div class="flex flex-col gap-5 md:gap-8">
        <div
          class="relative bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-shadow duration-300">
          <div class="p-6">
            <div class="grid grid-cols-2 gap-4">
              <div class="text-center p-4 bg-gradient-to-br from-primary-50 to-primary-100 rounded-lg">
                <div class="flex items-center justify-center w-12 h-12 mx-auto mb-3 rounded-xl bg-white shadow-md">
                  <i-lucide [name]="icons.users" class="size-6 text-primary-600 stroke-[1.5]" />
                </div>
                <div class="text-2xl font-black text-gray-900 mb-1">{{ ambassador.referralsCount || 0 }}</div>
                <div class="text-xs font-medium text-gray-600">{{ 'ambassadors.referrals' | translate }}</div>
              </div>

              <div class="text-center p-4 bg-gradient-to-br from-amber-50 to-amber-100 rounded-lg">
                <div class="flex items-center justify-center w-12 h-12 mx-auto mb-3 rounded-xl bg-white shadow-md">
                  <i-lucide [name]="icons.trendingUp" class="size-6 text-amber-600 stroke-[1.5]" />
                </div>
                <div class="text-2xl font-black text-gray-900 mb-1">{{ (ambassador.referralsCount || 0) * 10 }}</div>
                <div class="text-xs font-medium text-gray-600">Points</div>
              </div>
            </div>
          </div>
        </div>

        @if (ambassador.city || ambassador.country) {
        <div
          class="relative bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-shadow duration-300">
          <div class="p-6">
            <div class="flex items-center gap-3 mb-4">
              <div
                class="flex items-center justify-center w-11 h-11 rounded-xl bg-gradient-to-br from-blue-50 to-blue-100 text-blue-600">
                <i-lucide [name]="icons.mapPin" class="size-6 stroke-[1.5]" />
              </div>
              <h4 class="text-xl font-bold text-gray-900">Localisation</h4>
            </div>
            <p class="text-gray-700 leading-relaxed">
              {{ ambassador.city }}{{ ambassador.city && ambassador.country ? ', ' : '' }}{{ ambassador.country }}
            </p>
          </div>
        </div>
        }

        @if (ambassador.email || ambassador.phone_number) {
        <div
          class="relative bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-shadow duration-300">
          <div class="p-6">
            <div class="flex items-center gap-3 mb-4">
              <div
                class="flex items-center justify-center w-11 h-11 rounded-xl bg-gradient-to-br from-green-50 to-green-100 text-green-600">
                <i-lucide [name]="icons.mail" class="size-6 stroke-[1.5]" />
              </div>
              <h4 class="text-xl font-bold text-gray-900">Contact</h4>
            </div>
            <div class="space-y-3">
              @if (ambassador.email) {
              <div class="flex items-center gap-3">
                <i-lucide [name]="icons.mail" class="size-5 text-gray-400 stroke-[1.5]" />
                <a [href]="'mailto:' + ambassador.email" class="text-gray-700 hover:text-primary-600 transition-colors">
                  {{ ambassador.email }}
                </a>
              </div>
              } @if (ambassador.phone_number) {
              <div class="flex items-center gap-3">
                <i-lucide [name]="icons.phone" class="size-5 text-gray-400 stroke-[1.5]" />
                <a
                  [href]="'tel:' + ambassador.phone_number"
                  class="text-gray-700 hover:text-primary-600 transition-colors">
                  {{ ambassador.phone_number }}
                </a>
              </div>
              }
            </div>
          </div>
        </div>
        }

        @if (ambassador.biography) {
        <div
          class="relative bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-shadow duration-300">
          <div class="p-6">
            <div class="mb-6 flex items-center gap-3 justify-between">
              <div class="flex items-center gap-3">
                <div
                  class="flex items-center justify-center w-11 h-11 rounded-xl bg-gradient-to-br from-purple-50 to-purple-100 text-purple-600">
                  <i-lucide [name]="icons.info" class="size-6 stroke-[1.5]" />
                </div>
                <h4 class="text-xl font-bold text-gray-900">Biographie</h4>
              </div>
              <button
                type="button"
                class="flex items-center justify-center w-9 h-9 rounded-full bg-purple-100 hover:bg-purple-200 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-offset-2"
                (click)="toggleBiography()">
                <i-lucide
                  [name]="icons.chevronUp"
                  class="size-5 transition-transform duration-300"
                  [ngClass]="expandedBiography() ? 'rotate-180 text-purple-700' : 'rotate-0 text-purple-600'" />
              </button>
            </div>
            <div class="relative">
              <p
                class="text-gray-700 leading-relaxed transition-all duration-500 ease-in-out overflow-hidden"
                [ngClass]="expandedBiography() ? 'max-h-[500px] opacity-100 border border-primary-100 bg-primary-50/30 rounded-lg p-3' : 'max-h-[3.5em] opacity-80 line-clamp-2'">
                {{ ambassador.biography }}
              </p>
            </div>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
  } @else if (store.isLoading()) {
  <div class="flex justify-center items-center py-20">
    <div class="text-center">
      <div class="relative inline-block">
        <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-primary-600"></div>
        <div class="absolute inset-0 rounded-full border-4 border-primary-100"></div>
      </div>
      <p class="text-gray-600 mt-4 font-medium">{{ 'common.loading' | translate }}</p>
    </div>
  </div>
  } @else {
  <div class="text-center py-20">
    <div
      class="inline-flex items-center justify-center w-24 h-24 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full mb-6">
      <i-lucide [name]="icons.users" class="w-12 h-12 text-gray-400" [strokeWidth]="2" />
    </div>
    <h2 class="text-3xl font-black text-gray-900 mb-4">Ambassadeur introuvable</h2>
    <p class="text-gray-600 mb-8">Cet ambassadeur n'existe pas ou a été supprimé.</p>
    <a routerLink="/ambassadeurs" class="dashboard-btn-primary inline-flex items-center gap-2">
      Retour aux ambassadeurs
    </a>
  </div>
  }
</section>
