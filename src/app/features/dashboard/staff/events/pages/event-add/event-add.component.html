<section class="pt-32 dashboard-main-content flex flex-col gap-4">
  <div class="mb-4">
    <button class="text-primary-400 hover:underline flex items-center gap-2" (click)="onGoBack()">
      <i-lucide [name]="icons.back" class="size-4" />
      Revenir en arrière
    </button>
    <h5 class="text-2xl font-bold">Ajouter un projet</h5>
  </div>

  <form class="w-full md:w-2/3" [formGroup]="form" (ngSubmit)="onAddEvent()">
    <p-stepper [value]="1" class="w-full">
      <p-step-list class="w-full overflow-x-scroll scrollbar-hide">
        <p-step [value]="1" />
        <p-step [value]="2" />
      </p-step-list>
      <p-step-panels>
        <p-step-panel [value]="1">
          <ng-template #content let-activateCallback="activateCallback">
            <div class="flex flex-col gap-4">
              <div class="flex flex-col gap-1.5">
                <label for="name" class="font-medium">Nom de l'événement<span class="text-red-500">*</span></label>
                <input pInputText id="name" formControlName="name" />
              </div>
              <div class="flex flex-col gap-1.5">
                <label for="form_link" class="font-medium">Lien du formulaire<span class="text-red-500">*</span></label>
                <input pInputText id="form_link" formControlName="form_link" />
              </div>
              <div class="flex flex-col gap-1.5">
                <label for="place" class="font-medium">Lieu<span class="text-red-500">*</span></label>
                <input pInputText id="place" formControlName="place" />
              </div>
              <div class="flex flex-col gap-1.5">
                <p class="font-medium">Description<span class="text-red-500">*</span></p>
                <textarea pTextarea formControlName="description" rows="8" cols="30"></textarea>
              </div>
              <div class="flex justify-end">
                <p-button size="small" variant="outlined" (onClick)="activateCallback(2)">
                  Suivant
                  <i-lucide [name]="icons.next" class="size-4" />
                </p-button>
              </div>
            </div>
          </ng-template>
        </p-step-panel>
        <p-step-panel [value]="2">
          <ng-template #content let-activateCallback="activateCallback">
            <div class="flex flex-col gap-4">
              <div class="flex flex-col gap-1.5">
                <p class="font-medium">Programme</p>
                <p-select
                  inputId="program"
                  [optionValue]="'id'"
                  [optionLabel]="'name'"
                  [options]="programsStore.programs()"
                  formControlName="program"
                  class="w-full" />
              </div>
              <div class="flex flex-col gap-1.5">
                <p class="font-medium">Catégories</p>
                <p-multiselect
                  [inputId]="'categories'"
                  [autocomplete]="'off'"
                  [showHeader]="false"
                  [options]="categoriesStore.categories()"
                  [optionValue]="'id'"
                  [optionLabel]="'name'"
                  [showClear]="true"
                  formControlName="categories">
                </p-multiselect>
              </div>
              <div class="flex flex-col gap-1.5">
                <p class="font-medium">Date de début</p>
                <p-datepicker formControlName="started_at" />
              </div>
              <div class="flex flex-col gap-1.5">
                <p class="font-medium">Date de fin</p>
                <p-datepicker formControlName="ended_at" />
              </div>
              <div class="flex py-6 justify-between">
                <p-button size="small" variant="outlined" severity="secondary" (onClick)="activateCallback(1)">
                  <i-lucide [name]="icons.previous" class="size-4" />
                  Précedent
                </p-button>
                <p-button
                  [loading]="store.isLoading()"
                  [disabled]="store.isLoading() || form.invalid"
                  size="small"
                  type="submit">
                  Finaliser
                  @if (!store.isLoading()) {
                    <i-lucide [name]="icons.check" class="size-4" />
                  }
                </p-button>
              </div>
            </div>
          </ng-template>
        </p-step-panel>
      </p-step-panels>
    </p-stepper>
  </form>
</section>
