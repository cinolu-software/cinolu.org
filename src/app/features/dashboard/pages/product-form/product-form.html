<div class="w-full">
  <div class="mb-8">
    <h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">
      {{ isEditMode() ? 'Modifier le produit' : 'Créer un produit' }}
    </h1>
    <p class="text-gray-600">
      {{ isEditMode() ? 'Mettez à jour les informations de votre produit' : 'Ajoutez un nouveau produit ou service' }}
    </p>
  </div>

  <form
    [formGroup]="form"
    (ngSubmit)="onSubmit()"
    class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 md:p-8">
    <div class="grid grid-cols-1 gap-6 mb-6">
      <div>
        <label for="ventureId" class="block text-sm font-semibold text-gray-700 mb-2">
          Entreprise <span class="text-red-500">*</span>
        </label>
        <select
          id="ventureId"
          formControlName="ventureId"
          class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-primary-500 focus:outline-none transition-colors">
          <option value="">Sélectionner une entreprise</option>
          @for (venture of venturesStore.ventures(); track venture.id) {
          <option [value]="venture.id">{{ venture.name }}</option>
          }
        </select>
        @if (form.get('ventureId')?.invalid && form.get('ventureId')?.touched) {
        <p class="text-red-500 text-sm mt-1">Veuillez sélectionner une entreprise</p>
        }
      </div>

      <div>
        <label for="name" class="block text-sm font-semibold text-gray-700 mb-2">
          Nom du produit <span class="text-red-500">*</span>
        </label>
        <input
          id="name"
          type="text"
          formControlName="name"
          class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-primary-500 focus:outline-none transition-colors"
          placeholder="Ex: Service de consultation" />
        @if (form.get('name')?.invalid && form.get('name')?.touched) {
        <p class="text-red-500 text-sm mt-1">Le nom du produit est requis</p>
        }
      </div>

      <div>
        <label for="price" class="block text-sm font-semibold text-gray-700 mb-2">
          Prix <span class="text-red-500">*</span>
        </label>
        <input
          id="price"
          type="number"
          step="0.01"
          min="0"
          formControlName="price"
          class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-primary-500 focus:outline-none transition-colors"
          placeholder="0.00" />
        @if (form.get('price')?.invalid && form.get('price')?.touched) {
        <p class="text-red-500 text-sm mt-1">Le prix doit être supérieur ou égal à 0</p>
        }
      </div>

      <div>
        <label for="description" class="block text-sm font-semibold text-gray-700 mb-2">
          Description <span class="text-red-500">*</span>
        </label>
        <textarea
          id="description"
          formControlName="description"
          rows="6"
          maxlength="255"
          class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-primary-500 focus:outline-none transition-colors resize-none"
          placeholder="Décrivez votre produit ou service (maximum 255 caractères)..."></textarea>
        <div class="flex justify-between items-center mt-1">
          @if (form.get('description')?.invalid && form.get('description')?.touched) {
          <p class="text-red-500 text-sm">La description est requise</p>
          } @else {
          <p class="text-gray-500 text-sm">{{ form.get('description')?.value?.length || 0 }} / 255 caractères</p>
          }
        </div>
      </div>
    </div>

    <div class="flex flex-col sm:flex-row gap-3 justify-end pt-6 border-t border-gray-200">
      <button
        type="button"
        (click)="cancel()"
        class="px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold rounded-lg transition-colors">
        Annuler
      </button>
      <button
        type="submit"
        [disabled]="form.invalid || productsStore.isLoading()"
        class="px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 justify-center">
        @if (productsStore.isLoading()) {
        <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
        <span>{{ isEditMode() ? 'Mise à jour...' : 'Création...' }}</span>
        } @else {
        <span>{{ isEditMode() ? 'Mettre à jour' : 'Créer le produit' }}</span>
        }
      </button>
    </div>
  </form>
</div>
