<div
  class="bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden group hover:-translate-y-1">
  <div class="relative">
    <div
      class="h-1.5 w-full"
      [class.bg-gradient-to-r]="true"
      [class.from-red-400]="program().performance < 50"
      [class.to-red-600]="program().performance < 50"
      [class.from-yellow-400]="program().performance >= 50 && program().performance < 80"
      [class.to-yellow-600]="program().performance >= 50 && program().performance < 80"
      [class.from-green-400]="program().performance >= 80"
      [class.to-green-600]="program().performance >= 80"></div>

    <div class="p-5">
      <div class="flex items-start justify-between mb-3">
        <span class="bg-gray-100 text-gray-700 text-xs font-bold px-2.5 py-1 rounded-full"> #{{ index() + 1 }} </span>
        <div
          class="px-3 py-1 rounded-full text-xs font-bold"
          [class.bg-red-50]="program().performance < 50"
          [class.text-red-700]="program().performance < 50"
          [class.bg-yellow-50]="program().performance >= 50 && program().performance < 80"
          [class.text-yellow-700]="program().performance >= 50 && program().performance < 80"
          [class.bg-green-50]="program().performance >= 80"
          [class.text-green-700]="program().performance >= 80">
          {{ program().performance < 50 ? 'Faible' : (program().performance < 80 ? 'Moyen' : 'Excellent') }}
        </div>
      </div>

      <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2 min-h-[3.5rem]">{{ program().name }}</h3>
      <div class="flex items-center gap-2 text-sm text-gray-600 mb-4">
        <i-lucide [img]="icons.barChart" class="text-gray-400 w-4 h-4 stroke-[2]" />
        <span>{{ program().indicators.length }} indicateur{{ program().indicators.length > 1 ? 's' : '' }}</span>
      </div>

      <div class="mb-4 space-y-2 max-h-20 scrollbar-hide overflow-y-auto pr-1">
        @for (indicator of program().indicators; track indicator.name) {
        <div
          class="flex items-center justify-between text-xs bg-gray-50 rounded-lg p-2 hover:bg-gray-100 transition-colors">
          <div class="flex-1 min-w-0 mr-2">
            <p class="font-medium text-gray-700 truncate">{{ indicator.name }}</p>
          </div>
          <div class="flex items-center gap-2 flex-shrink-0">
            <div class="flex items-center gap-1">
              <i-lucide [img]="icons.flag" class="text-blue-500 w-3 h-3 stroke-[2.5]" />
              <span class="font-bold text-blue-600">{{ indicator.target ?? 'N/A' }}</span>
            </div>
            <span class="text-gray-400">/</span>
            <div class="flex items-center gap-1">
              <i-lucide [img]="icons.check" class="text-green-500 w-3 h-3 stroke-[2.5]" />
              <span class="font-bold text-green-600">{{ indicator.achieved }}</span>
            </div>
          </div>
        </div>
        }
      </div>

      <div class="flex items-center justify-between">
        <div class="flex-1">
          <p class="text-xs text-gray-500 font-medium mb-2">Performance globale</p>
          <div class="h-2.5 bg-gray-200 rounded-full overflow-hidden">
            <div
              class="h-full transition-all duration-500 rounded-full"
              [class.bg-gradient-to-r]="true"
              [class.from-red-400]="program().performance < 50"
              [class.to-red-600]="program().performance < 50"
              [class.from-yellow-400]="program().performance >= 50 && program().performance < 80"
              [class.to-yellow-600]="program().performance >= 50 && program().performance < 80"
              [class.from-green-400]="program().performance >= 80"
              [class.to-green-600]="program().performance >= 80"
              [style.width.%]="program().performance > 100 ? 100 : program().performance"></div>
          </div>
        </div>
        <div class="ml-4">
          <app-circular-progress [percentage]="program().performance" [size]="64" [strokeWidth]="4" />
        </div>
      </div>
    </div>
  </div>
</div>
