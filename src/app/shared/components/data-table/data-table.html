<div class="data-table bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
  @if (title()) {
  <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
    <h3 class="text-lg font-semibold text-gray-900">{{ title() }}</h3>
  </div>
  }
  <p-table
    [value]="data()"
    [columns]="columns()"
    [paginator]="paginator()"
    [rows]="rows()"
    [totalRecords]="totalRecords()"
    [loading]="loading()"
    [lazy]="lazy()"
    (onLazyLoad)="onLazyLoadData($event)"
    styleClass="p-datatable-sm p-datatable-striped">
    <ng-template pTemplate="header" let-columns>
      <tr>
        @for (col of columns; track col.key) {
        <th [pSortableColumn]="col.sortable ? col.key : null" [style.width]="col.width">
          {{ col.label }} @if (col.sortable) {
          <p-sortIcon [field]="col.key"></p-sortIcon>
          }
        </th>
        } @if (actions() && actions()!.length > 0) {
        <th style="width: 150px">Actions</th>
        }
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
      <tr>
        @for (col of columns; track col.key) {
        <td>
          @switch (col.format) { @case ('badge') {
          <p-chip [label]="rowData[col.key]?.toString()" [styleClass]="badgeClassFn()(rowData[col.key])"> </p-chip>
          } @case ('date') { {{ rowData[col.key] | date: 'dd/MM/yyyy HH:mm' }} } @case ('number') { {{ rowData[col.key]
          | number }} } @default { {{ rowData[col.key] }} } }
        </td>
        } @if (actions() && actions()!.length > 0) {
        <td>
          <div class="flex gap-2 items-center">
            @for (action of visibleActionsFn()(rowData); track action.label) {
            <button
              pButton
              [title]="action.label"
              [ngClass]="actionButtonClassFn()(action)"
              class="!p-2.5 !rounded-lg !transition-all !shadow-sm hover:!shadow-md"
              (click)="action.callback(rowData)">
              <i-lucide [img]="action.icon" class="w-4 h-4"></i-lucide>
            </button>
            }
          </div>
        </td>
        }
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td [attr.colspan]="columns().length + (actions() ? 1 : 0)" class="text-center py-8">
          <div class="flex flex-col items-center gap-3">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              class="w-12 h-12 text-gray-400">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M3 7h4l2-3h6l2 3h4v11a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 12h4v4h-4z" />
            </svg>
            <p class="text-gray-500">{{ emptyMessage() }}</p>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
