<section class="px-8 mx-auto md:max-w-screen-lg 2xl:max-w-screen-xl xl:px-0 pt-24 mb-20">
  @let categories = categories$ | async;
  @let members = members$ | async;

  @if (categories?.data?.length > 0) {
    <div class="mb-10" data-aos="fade-up">
      <h2 class="font-black font-satoshi mb-2 text-2xl md:text-4xl">Our Ecosystem</h2>
      <p class="mb-4 text-primary-600 font-satoshi">Notre écosystème</p>
    </div>
    <div class="flex flex-wrap gap-4 font-medium">
      <button
        class="rounded-md text-gray-700 transition-colors duration-300 bg-primary-200/50 px-3 py-1.5"
        [ngClass]="{
          'bg-primary-600 text-white': activeTab() === 'Tous'
        }"
        (click)="setActiveTab('Tous')">
        Tous
      </button>
      @for (category of categories.data; track $index) {
        <button
          class="flex items-center gap-1.5 transition-colors duration-300 rounded-md text-gray-700 bg-primary-200/50 px-3 py-1.5"
          [ngClass]="{
            'bg-primary-600 text-white': activeTab() === category.name
          }"
          (click)="setActiveTab(category.name)">
          <ng-icon
            [name]="icons[category.name]"
            class="size-4! text-gray-700"
            [ngClass]="{
              'text-primary-50!': activeTab() === category.name
            }" />
          {{ category.name }}
        </button>
      }
    </div>

    <div class="mt-10 grid grid-cols-2 md:grid-cols-3 gap-8">
      @if (members?.isLoading) {
        @for (x of [1, 3, 4, 5, 6, 6, 6, 6]; track $index) {
          <div class="p-5 h-[250px] flex flex-col gap-2 shadow-md border border-gray-200 rounded-md animate-pulse mb-4">
            <div class="relative h-16 w-16 rounded-sm overflow-hidden bg-gray-100"></div>
            <div class="mt-2 flex gap-2 flex-wrap">
              <div class="h-4 w-10 mb-3 rounded-full bg-gray-100"></div>
              <div class="h-4 w-12 rounded-full bg-gray-100"></div>
            </div>
            <div class="h-4 w-32 rounded-sm mb-2 bg-gray-100"></div>
            <div class="h-4 w-32 rounded-sm bg-gray-100"></div>
          </div>
        }
      }

      @if (members?.data?.length === 0) {
        <div class="text-gray-500">
          <ng-icon name="matInfoOutline" class="size-5!" />
          Aucun membre trouvé
        </div>
      }

      @if (members?.data?.length > 0) {
        @for (member of members?.data; track member.id) {
          <a
            target="_blank"
            [href]="member.website"
            class="p-5 flex flex-col gap-2 bg-gray-50/10 shadow-md rounded-md hover:scale-105 duration-300 transition-transform">
            <div class="relative h-16 w-16 rounded-sm overflow-hidden">
              <img [ngSrc]="member | apiIMG: 'member'" alt="Member's logo" fill />
            </div>
            <ul class="mt-2 flex flex-wrap">
              @for (category of member.categories; track category.id) {
                <li class="mr-1.5 mt-2">
                  <div
                    class="flex items-center rounded-full bg-primary-400/10 px-3 py-1 text-xs font-medium leading-5 text-primary-800">
                    {{ category.name }}
                  </div>
                </li>
              }
            </ul>
            <h3 class="font-medium mb-2.5">
              {{ member.name | titlecase }}
            </h3>
            <div class="flex items-center text-md leading-5 mb-2">
              <ng-icon class="text-hint size-5!" name="matLocationOnOutline" />
              <div class="ml-1.5">{{ member.location | titlecase }}</div>
            </div>
          </a>
        }
      }
    </div>
  }
</section>
